{"version":3,"sources":["webpack://xmliving/./assets/src/config.js"],"names":["document","addEventListener","qf","selector","func","parent","selectors","querySelectorAll","forEach","call","qs","querySelector","xConfig","xContent","form","parentNode","removeChild","appendChild","xTabs","active","sessionStorage","getItem","el","classList","add","replace","preventDefault","stopPropagation","window","scrollTo","remove","target","className","dataset","class","setItem","fetch","then","response","json","serverVersion","title","substr","xNotice","innerHTML","content","currentVersion","arr1","split","arr2","length1","length","length2","minlength","Math","min","i","a","parseInt","b","j","compareVersion","version","catch","err","console","log"],"mappings":"AAAAA,SAASC,iBAAiB,oBAAoB,WAO1C,SAASC,EAAGC,EAAUC,EAAMC,EAASL,UAC5BK,IACDA,EAASL,UAEb,IAAIM,EAAYD,EAAOE,iBAAiBJ,GACxC,GAAGK,QAAQC,KAAKH,EAAWF,GAS/B,SAASM,EAAGP,EAAUE,EAASL,UAI3B,OAHKK,IACDA,EAASL,UAENK,EAAOM,cAAcR,GA2ChC,MAAMS,EAAUF,EAAG,aACfG,EAAWH,EAAG,aAAcE,GAGhC,IAAIE,EAAOF,EAAQG,WAAWJ,cAAc,QAC5CG,EAAKC,WAAWC,YAAYF,GAC5BD,EAASI,YAAYH,GAIrB,IAAII,EAAQR,EAAG,UAAWE,GACtBO,EAASC,eAAeC,QAAQ,cAC/BF,GAAqB,KAAXA,GAA4B,cAAXA,KAC5BA,EAAS,aAGbjB,EAAGiB,GAAQG,IACPA,EAAGC,UAAUC,IAAI,YAClBX,GACHX,EAAI,gBAAeiB,EAAOM,QAAQ,IAAK,SAASH,IAC5CA,EAAGC,UAAUC,IAAI,YAClBN,GAGH,GAAGV,QAAQC,KAAKS,EAAMX,iBAAiB,gBAAgBe,IACnDA,EAAGrB,iBAAiB,SAASqB,IACzBA,EAAGI,iBACHJ,EAAGK,kBACHC,OAAOC,SAAS,EAAG,GACnB3B,EAAG,cAAcoB,IACbA,EAAGC,UAAUO,OAAO,aAExBR,EAAGS,OAAOR,UAAUC,IAAI,UACxB,IAAIQ,EAAY,IAAMV,EAAGS,OAAOE,QAAQC,MACxCd,eAAee,QAAQ,WAAYH,GACnC,GAAGxB,QAAQC,KAAKI,EAASN,iBAAiB,YAAYe,IAClDA,EAAGC,UAAUO,OAAO,aAExB,GAAGtB,QAAQC,KAAKI,EAASN,iBAAiByB,IAAYV,IAClDA,EAAGC,UAAUC,IAAI,mBAM7BY,MAAM,uEACDC,MAAKC,GAAYA,EAASC,SAC1BF,MAAKE,IACF,IAAIC,EAAgBD,EAAKE,MAAMC,OAAO,EAAG,GACrCC,EAAUjC,EAAG,YAAaE,GAC1B6B,EAAQ/B,EAAG,SAAUE,GACzBF,EAAG,WAAY+B,GAAOX,SACtBpB,EAAG,kBAAmB+B,GAAOG,UAAYL,EAAKE,MAC9C/B,EAAG,WAAYiC,GAASC,UAAYL,EAAKM,QACzCnC,EAAG,kBAAmB+B,GAAOlB,UAAUC,IAAI,UAxFnD,SAAwBgB,EAAeM,GACnC,MAAMC,EAAOP,EAAcQ,MAAM,KAC3BC,EAAOH,EAAeE,MAAM,KAC5BE,EAAUH,EAAKI,OACfC,EAAUH,EAAKE,OACfE,EAAYC,KAAKC,IAAIL,EAASE,GACpC,IAAII,EAAI,EACR,KAAQA,EAAIH,EAAWG,IAAK,CACxB,IAAIC,EAAIC,SAASX,EAAKS,IAClBG,EAAID,SAAST,EAAKO,IACtB,GAAIC,EAAIE,EACJ,OAAO,EACJ,GAAIF,EAAIE,EACX,OAAQ,EAGhB,GAAIT,EAAUE,EAAS,CACnB,IAAK,IAAIQ,EAAIJ,EAAGI,EAAIV,EAASU,IACzB,GAA0B,IAAtBF,SAASX,EAAKa,IACd,OAAO,EAGf,OAAO,EACJ,GAAIV,EAAUE,EAAS,CAC1B,IAAK,IAAIQ,EAAIJ,EAAGI,EAAIR,EAASQ,IACzB,GAA0B,IAAtBF,SAAST,EAAKW,IACd,OAAQ,EAGhB,OAAO,EAEX,OAAO,EA0DCC,CAAerB,EAAeC,EAAMR,QAAQ6B,SAC5CpD,EAAG,gBAAiB+B,GAAOlB,UAAUC,IAAI,UAEzCd,EAAG,UAAW+B,GAAOlB,UAAUC,IAAI,aAG1CuC,OAAMC,GAAOC,QAAQC,IAAI,iBAAkBF","file":"js/xmliving.2.1.0.config.min.js","sourcesContent":["document.addEventListener('DOMContentLoaded', function () {\r\n    /**\r\n     * 应用函数到 DOMElement 数组\r\n     * @param selector\r\n     * @param func\r\n     * @param parent\r\n     */\r\n    function qf(selector, func, parent = document) {\r\n        if (!parent) {\r\n            parent = document;\r\n        }\r\n        let selectors = parent.querySelectorAll(selector);\r\n        [].forEach.call(selectors, func);\r\n    }\r\n\r\n    /**\r\n     * document.querySelector 缩写\r\n     * @param selector\r\n     * @param parent\r\n     * @returns {*}\r\n     */\r\n    function qs(selector, parent = document) {\r\n        if (!parent) {\r\n            parent = document;\r\n        }\r\n        return parent.querySelector(selector);\r\n    }\r\n\r\n    /**\r\n     * 版本号对比\r\n     * @returns {number}\r\n     * @param serverVersion 服务器版本\r\n     * @param currentVersion 当前版本\r\n     */\r\n    function compareVersion(serverVersion, currentVersion) {\r\n        const arr1 = serverVersion.split('.')\r\n        const arr2 = currentVersion.split('.')\r\n        const length1 = arr1.length\r\n        const length2 = arr2.length\r\n        const minlength = Math.min(length1, length2)\r\n        let i = 0\r\n        for (i; i < minlength; i++) {\r\n            let a = parseInt(arr1[i])\r\n            let b = parseInt(arr2[i])\r\n            if (a > b) {\r\n                return 1\r\n            } else if (a < b) {\r\n                return -1\r\n            }\r\n        }\r\n        if (length1 > length2) {\r\n            for (let j = i; j < length1; j++) {\r\n                if (parseInt(arr1[j]) !== 0) {\r\n                    return 1\r\n                }\r\n            }\r\n            return 0\r\n        } else if (length1 < length2) {\r\n            for (let j = i; j < length2; j++) {\r\n                if (parseInt(arr2[j]) !== 0) {\r\n                    return -1\r\n                }\r\n            }\r\n            return 0\r\n        }\r\n        return 0\r\n    }\r\n\r\n    const xConfig = qs('.x-config'),\r\n        xContent = qs('.x-content', xConfig);\r\n\r\n    // 移动表单\r\n    let form = xConfig.parentNode.querySelector('form');\r\n    form.parentNode.removeChild(form);\r\n    xContent.appendChild(form);\r\n\r\n\r\n    // 恢复现场\r\n    let xTabs = qs('.x-tabs', xConfig),\r\n        active = sessionStorage.getItem('x-active');\r\n    if (!active || active === \"\" && active === \"undefined\") {\r\n        active = '.x-notice'\r\n    }\r\n\r\n    qf(active, el => {\r\n        el.classList.add('active');\r\n    }, xContent);\r\n    qf(`[data-class=\"${active.replace('.', '')}\"]`, el => {\r\n        el.classList.add('active');\r\n    }, xTabs);\r\n\r\n    // 处理点击\r\n    [].forEach.call(xTabs.querySelectorAll(':scope > li'), el => {\r\n        el.addEventListener('click', el => {\r\n            el.preventDefault();\r\n            el.stopPropagation();\r\n            window.scrollTo(0, 0);\r\n            qf('.x-tabs li', el => {\r\n                el.classList.remove('active');\r\n            })\r\n            el.target.classList.add('active');\r\n            let className = '.' + el.target.dataset.class;\r\n            sessionStorage.setItem('x-active', className);\r\n            [].forEach.call(xContent.querySelectorAll('.x-item'), el => {\r\n                el.classList.remove('active');\r\n            });\r\n            [].forEach.call(xContent.querySelectorAll(className), el => {\r\n                el.classList.add('active');\r\n            });\r\n        });\r\n    });\r\n\r\n    // 加载日志\r\n    fetch('https://api.vvhan.com/api/qqsc?key=849c0dbcf06a813c96bb5ec532e21b54')\r\n        .then(response => response.json())\r\n        .then(json => {\r\n            let serverVersion = json.title.substr(0, 5),\r\n                xNotice = qs('.x-notice', xConfig),\r\n                title = qs('.title', xConfig);\r\n            qs('.loading', title).remove();\r\n            qs('.latest.version', title).innerHTML = json.title;\r\n            qs('.message', xNotice).innerHTML = json.content;\r\n            qs('.latest.version', title).classList.add('active');\r\n            if (compareVersion(serverVersion, title.dataset.version)) {\r\n                qs('.latest.found', title).classList.add('active');\r\n            } else {\r\n                qs('.latest', title).classList.add('active');\r\n            }\r\n        })\r\n        .catch(err => console.log('Request Failed', err));\r\n});"],"sourceRoot":""}